{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,6DAMA,MAAMC,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBAErD,IAAIE,EACAC,EAAO,GASXC,eAAeC,IACX,MAAMC,EARV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAKjBO,CAAS,MACrBC,EAASC,EAAAC,IAAIrB,EAAAsB,GAAI,WAAYZ,IAavC,SAAuBa,GAEnBlB,EAAqBmB,UAAY,uDAAuDD,EAAQE,IAAI,OAEpG,MACMC,EADuBnB,EAAKoB,MAAMC,GAAgBA,EAAYC,KAAON,EAAQM,KAE/E,mEAAkE,0DAGrE3B,EAAkBsB,UAAY,yEAWdD,EAAiBO,wDACpBC,EAASC,eAAAT,EAAAU,UAAAV,EAAAW,gEACnBX,EAAAY,2DAGIZ,EAAAa,yCAOR,MAAAC,EAAwBlC,SAAAmC,cAAA,iBAC3BD,EAAAE,iBAAA,SAAAC,IAGDjC,EAAAkC,KAAAlB,GACIQ,EAAAW,iBAAoBnC,GACZD,GAAEqC,EAAAC,mBAAA5C,EAAAsB,GAAAhB,EAAAuC,IAAAtC,GAEN8B,EAAAS,aAAA,YAAkB,GAClBT,EAAAU,UAAO,sBA7CXC,CALgB,WAHM5B,EAAA6B,OAAO9B,IACR+B,OAIjBrB,GAAInB,MAwDTyC,mBAAAnD,EAAAoD,MAAA5C,MAAA6C","sources":["src/product.js"],"sourcesContent":["import { db, auth } from '../src/functions/app'\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\nimport { onAuthStateChanged } from 'firebase/auth';\r\nimport { getFirebaseCart, createFirebaseCart} from '../src/functions/cart';\r\nimport { getMyLocalCart, addProductToCart, currencyFormat } from '../utils';\r\n\r\nconst productInfoSection = document.getElementById(\"productInfo\");\r\nconst productAssetsSection = document.getElementById(\"productAssets\");\r\n\r\nlet userLogged = undefined;\r\nlet cart = [];\r\n\r\nfunction getParam(param) {\r\n    const url = window.location.search;\r\n    const searchParams = new URLSearchParams(url);\r\n    const productId = searchParams.get(param);\r\n    return productId;\r\n}\r\n\r\nasync function getProduct() {\r\n    const productId = getParam(\"id\");\r\n    const docRef = doc(db, \"products\", productId);\r\n    const docSnap = await getDoc(docRef);\r\n    const data = docSnap.data();\r\n\r\n    const product = {\r\n        ...data,\r\n        id: productId,\r\n    }\r\n\r\n    renderProduct(product);\r\n\r\n}\r\n\r\nfunction renderProduct(product) {\r\n\r\n    productAssetsSection.innerHTML = `<img class=\"product__mainImage\" id=\"mainImage\" src=\"${product.img[0]}\">`;\r\n\r\n    const isProductAddedToCart = cart.some((productCart) => productCart.id === product.id);\r\n    const productButtonCart = isProductAddedToCart ?\r\n        '<button class=\"product_cart\" disabled>Producto añadido</button >' :\r\n        '<button class=\"product_cart\">Añadir al carrito</button>';\r\n\r\n    productInfoSection.innerHTML = `\r\n    <div class=\"product__container\">\r\n    <h1 class=\"product__name\">${product.name}</h1>\r\n    <p class=\"product__description color\">${currencyFormat(product.price)} ${product.description}</p>\r\n    <p class=\"product__description\">Vegano: ${product.vegano}</p>\r\n    <p class=\"product__description\">Azúcar: ${product.azucar}</p>\r\n    ${productButtonCart}\r\n    </div>\r\n    `;\r\n\r\n    const productCartButon = document.querySelector(\".product_cart\");\r\n    productCartButon.addEventListener(\"click\", (e) => {\r\n        cart.push(product);\r\n        addProductToCart(cart);\r\n\r\n        if (userLogged) {\r\n            createFirebaseCart(db,userLogged.uid,cart);\r\n        }\r\n\r\n        productCartButon.setAttribute(\"disabled\", true);\r\n        productCartButon.innerText = \"Producto añadido\";\r\n    });\r\n\r\n    // console.log(product);\r\n}\r\n\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    //console.log(user);\r\n    if (user) {\r\n\r\n        userLogged = user;\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n        // console.log(cart);\r\n    } else {\r\n        cart = getMyLocalCart();\r\n\r\n    }\r\n\r\n    getProduct();\r\n});\r\n\r\n"],"names":["$4Bu0d","parcelRequire","$4561a5f183cf30d8$var$productInfoSection","document","getElementById","$4561a5f183cf30d8$var$productAssetsSection","$4561a5f183cf30d8$var$userLogged","$4561a5f183cf30d8$var$cart","async","$4561a5f183cf30d8$var$getProduct","productId","param","url","window","location","search","URLSearchParams","get","$4561a5f183cf30d8$var$getParam","docRef","$etBjH","doc","db","product","innerHTML","img","productButtonCart","some","productCart","id","name","$aDR0T","currencyFormat","price","description","vegano","azucar","productCartButon","querySelector","addEventListener","e","push","addProductToCart","$6naOk","createFirebaseCart","uid","setAttribute","innerText","$4561a5f183cf30d8$var$renderProduct","getDoc","data","onAuthStateChanged","auth","user"],"version":3,"file":"product.3d4f7136.js.map"}