{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,wEAQA,MAAMC,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,SACvCE,EAAcH,SAASC,eAAe,gBAE5C,IACIG,EADAC,EAAO,GAGX,SAASC,EAASC,GAEd,IAAIC,EAAQ,EACZD,EAAKE,SAAQC,KA0BjB,SAAuBA,GACnB,MAAMC,EAAcX,SAASY,cAAc,MAE3CD,EAAYE,UAAY,UACxBF,EAAYG,UAAY,qBAYZJ,EAAAK,6DACYL,EAAKM,kDACKC,EAAAC,eAAAR,EAAAS,UAAAT,EAAAU,0FAGjCC,YAAAV,GACJA,EAAAW,iBAAA,SAAAC,IAEU,WAAXA,EAAAC,OAAAC,UACWC,QAASC,IAAI,cA1CxBC,eAA6BC,GACzB,MAAMC,EAAUzB,EAAK0B,QAAOrB,GAAWA,EAAQsB,KAAOH,IAEtDxB,EAAOyB,EAEH1B,SACM6B,EAAAC,mBAAmBrC,EAAAsC,GAAI/B,EAAWgC,IAAKN,GAGjDb,EAAAoB,iBAAiBP,GAEjB/B,EAAYe,UAAY,GAExBR,EAASwB,GA8BXQ,CAAA5B,EAAAsB,QAnDMO,CAAc7B,GACdF,GAASgC,SAAS9B,EAAQS,UAG9BjB,EAAauC,UAAY,kBAAoBxB,EAAAC,eAAeV,KAsDpDc,iBAAS,SAAAC,WAGbmB,SAAAC,KAAA,uBAMLC,mBAAA/C,EAAAgD,MAAAjB,MAAAkB","sources":["src/shopping.js"],"sourcesContent":["import { db, auth } from '../src/functions/app';\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\r\nimport { addProductToCart } from \"../utils/index\";\r\nimport { getMyLocalCart, currencyFormat } from \"../utils/index\";\r\nimport { doc } from 'firebase/firestore';\r\n\r\n\r\nconst cartSection = document.getElementById(\"cart\");\r\nconst totalSection = document.getElementById(\"total\");\r\nconst shoppingBtn = document.getElementById(\"shopping_btn\");\r\n\r\nlet cart = [];\r\nlet userLogged = undefined;\r\n\r\nfunction loadCart(cart) {\r\n\r\n    let total = 0;\r\n    cart.forEach(product => {\r\n        renderProduct(product);\r\n        total += parseInt(product.price);\r\n    });\r\n\r\n    totalSection.innerText = \"Total a pagar: \" + currencyFormat(total);\r\n    \r\n};\r\n\r\nasync function removeProduct(productId) {\r\n    const newCart = cart.filter(product => product.id !== productId);\r\n\r\n    cart = newCart;\r\n\r\n    if (userLogged) {\r\n        await createFirebaseCart(db, userLogged.uid, newCart);\r\n    }\r\n\r\n    addProductToCart(newCart);\r\n\r\n    cartSection.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n}\r\n\r\n\r\nfunction renderProduct(product) {\r\n    const productCart = document.createElement(\"li\");\r\n\r\n    productCart.className = \"product\";\r\n    productCart.innerHTML = `\r\n\r\n    <img src=\"${product.img}\" class=\"product_image\">\r\n    <h2 class=\"product_name\">${product.name}</h2>\r\n    <h3 class=\"product_description\">${currencyFormat(product.price)} ${product.description}</h3>\r\n    <button class=\"product_delete\">Eliminar producto</button>\r\n    `;\r\n\r\n    cartSection.appendChild(productCart);\r\n    \r\n\r\n   \r\n    productCart.addEventListener(\"click\", e => {\r\n        if (e.target.tagName === \"BUTTON\") {\r\n            console.log(\"remove it!\");\r\n            removeProduct(product.id);\r\n        }\r\n   })\r\n};\r\n\r\nshoppingBtn.addEventListener(\"click\", e => {\r\n    window.location.href = (\"./checkout.html\");\r\n})\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    \r\n    if (user) {\r\n\r\n        userLogged = user;\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n\r\n    } else {\r\n        cart = getMyLocalCart();\r\n\r\n    }\r\n\r\n    loadCart(cart);\r\n\r\n});"],"names":["$4Bu0d","parcelRequire","$679f288ffe2eca98$var$cartSection","document","getElementById","$679f288ffe2eca98$var$totalSection","$679f288ffe2eca98$var$shoppingBtn","$679f288ffe2eca98$var$userLogged","$679f288ffe2eca98$var$cart","$679f288ffe2eca98$var$loadCart","cart","total","forEach","product","productCart","createElement","className","innerHTML","img","name","$aDR0T","currencyFormat","price","description","appendChild","addEventListener","e","target","tagName","console","log","async","productId","newCart","filter","id","$6naOk","createFirebaseCart","db","uid","addProductToCart","$679f288ffe2eca98$var$removeProduct","$679f288ffe2eca98$var$renderProduct","parseInt","innerText","location","href","onAuthStateChanged","auth","user"],"version":3,"file":"shopping.e826f0d7.js.map"}